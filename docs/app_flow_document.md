# App Flow Document

## Onboarding and Sign-In/Sign-Up
A new user arrives at the marketing landing page, greeted by a bold hero area showcasing sample images and a clear call to action to either browse or create an account. From this page, the user can click “Sign Up” to open a form asking for their email address, a chosen password, and acceptance of the terms of service. After submitting, Supabase sends an email verification link. Once the user clicks that link, they are brought back to the site to complete verification and are automatically signed in. If a returning user clicks “Sign In,” they are presented with fields for email and password. Upon successful authentication, Supabase returns a session token stored in the browser, allowing them to remain logged in across visits. If the user forgets their password, they can select “Forgot Password” which prompts them for their email; Supabase then sends a secure reset link. The user follows that link, enters a new password, and regains access. A “Sign Out” option is always visible in the top navigation after login, clearing the session token and returning the user to the landing page. For extra security, an optional two-factor authentication prompt can appear after successful password entry, sending a code to the user’s email before granting access to protected pages.

## Main Dashboard or Home Page
After signing in, the user is redirected to the default dashboard view, which is the Browse Images page. At the very top, a persistent header displays the site logo on the left, a global search bar in the center, and the user’s name with a dropdown for account settings on the right. Directly below, a filter panel lets the user refine results by category, color palette, orientation, resolution, and keywords. The main area shows a responsive grid of watermarked image and video previews. A secondary navigation sidebar on the left provides quick links to Downloads, Invoices, Subscriptions, and a link back to the main Browse Images page. Every item in the grid is clickable, taking the user to a detailed view. The header and sidebar remain visible so that the user can move instantly between sections without losing context.

## Detailed Feature Flows and Page Transitions
When the user enters a search term or toggles filters on the Browse Images page, the grid updates in real time. Selecting a preview opens the image detail page. This page shows a larger watermarked preview or video player sample, followed by metadata fields such as title, description, tags, categories, subcategories, alt text, and copyright information. Tiered one-time purchase prices and subscription download allowances appear alongside download buttons. If the user clicks “Purchase One Time,” they are taken to a Stripe Checkout session where the chosen price and applicable sales tax are displayed. If the user selects a subscription plan, they see options for monthly or yearly billing, each with its included download limit per asset type. In either case, the user completes payment inside Stripe’s secure modal and, on success, is redirected to a confirmation page. This page offers an immediate download link for the selected resolution or file format (PNG, JPG, or MP4) and a button to view the invoice in the user dashboard. While the confirmation page displays, the backend records the transaction in Supabase, adjusts the user’s remaining download allowances, and triggers an email with the invoice PDF.

On the user dashboard, clicking “Downloads” shows a list of previously purchased items with buttons to download each file at any available resolution. Selecting “Invoices” brings up a history of billing records. Clicking an invoice opens a PDF in a new tab. In “Subscriptions,” the user sees their active plan, usage statistics, next billing date, and a button to manage or cancel. When they click “Manage Subscription,” they are seamlessly redirected into the Stripe Customer Portal to upgrade, downgrade, or cancel. After making changes, they return to the main dashboard automatically.

Administrators access a separate admin portal by signing in at `/admin`, using the same Supabase credentials but with role-based access control. Content managers arrive at an image library page where they can upload new assets, fill in required metadata, and choose available resolutions and file formats. They also configure search facets such as new categories, color swatches, or orientations. Super-admins see an extended sidebar with a Financial Overview page that displays revenue analytics, sales tax reports, subscription statistics, and transaction details. From the Financial Overview they can adjust global tier pricing or override individual image prices. Content managers cannot view any financial or billing data.

## Settings and Account Management
The user can open “Account Settings” from their name dropdown in the header. Here they can update personal details like first and last name, email, or password. A notifications section lets them opt in or out of email alerts for new releases, upcoming renewals, or marketing newsletters. If they have saved payment methods, those appear under Billing, with the option to add, edit, or remove cards. Any changes are sent to Stripe and stored securely without exposing sensitive details in the app. After making updates, users can click “Save Changes,” which updates their Supabase user record and returns them to the previous dashboard page.

## Error States and Alternate Paths
If a user submits invalid credentials on the sign-in form, they see a clear error message explaining that the email or password is incorrect. Attempting to access protected routes without being authenticated automatically redirects them to the sign-in page with a prompt to log in. Should the user’s session expire, any API call returns a 401 status and the app signs the user out, returning them to the landing page with a message about their session timing out. During checkout, if payment fails, the Stripe modal presents an error with instructions to try a different payment method. If the user attempts to download beyond their subscription limit, the download button appears disabled with a message directing them to “Upgrade or Purchase More Downloads.” In cases of lost network connectivity, a banner alerts the user that they are offline and disables actions until the connection is restored.

## Conclusion and Overall App Journey
From landing on the public site to completing a purchase, users follow a clear path: create an account or sign in, browse watermarked previews with powerful search and filtering, view detailed metadata on each asset, and choose to buy one time or subscribe. After successful payment via Stripe, users gain immediate access to downloads and invoices within their dashboard. They manage personal details and payment methods in account settings and handle subscription changes through Stripe’s portal. Administrators oversee content, metadata, and pricing in a role-based admin dashboard, with super-admins also accessing financial reports. Throughout this seamless flow, the user moves naturally from discovery to purchase to daily usage, empowered by clear navigation, instant feedback, and a consistent interface.